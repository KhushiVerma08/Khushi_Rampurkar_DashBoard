<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Dashboard: TATA POWER vs NTPC</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        :root {
            --primary: #1f77b4;
            --secondary: #ff7f0e;
            --background: #f8f9fa;
            --card-bg: #ffffff;
            --text: #333333;
            --border: #e0e0e0;
            --success: #28a745;
            --warning: #ffc107;
            --info: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background);
            color: var(--text);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            border: 1px solid var(--border);
        }
        
        .logo-container {
            width: 120px;
            height: 80px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: linear-gradient(135deg, #1f77b4, #0d5a8a);
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .header-content {
            flex: 1;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        h2 {
            font-size: 1.6rem;
            margin: 20px 0 15px;
            color: var(--primary);
            border-bottom: 2px solid var(--border);
            padding-bottom: 8px;
        }
        
        h3 {
            font-size: 1.3rem;
            margin: 15px 0 10px;
            color: var(--secondary);
        }
        
        h4 {
            font-size: 1.1rem;
            margin: 12px 0 8px;
            color: var(--primary);
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid var(--border);
        }
        
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .metric-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary);
            border: 1px solid var(--border);
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .metric-delta {
            font-size: 0.9rem;
            padding: 3px 8px;
            border-radius: 4px;
            display: inline-block;
        }
        
        .delta-positive {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success);
        }
        
        .delta-negative {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning);
        }
        
        .chart-container {
            margin: 15px 0;
            height: 300px;
        }
        
        .insights-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .insight-item {
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: rgba(23, 162, 184, 0.05);
            border-left: 3px solid var(--info);
        }
        
        .insight-positive {
            border-left-color: var(--success);
            background-color: rgba(40, 167, 69, 0.05);
        }
        
        .insight-warning {
            border-left-color: var(--warning);
            background-color: rgba(255, 193, 7, 0.05);
        }
        
        select {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid var(--border);
            background-color: white;
            font-size: 1rem;
            margin-bottom: 15px;
            margin-right: 15px;
        }
        
        .divider {
            height: 1px;
            background-color: var(--border);
            margin: 25px 0;
        }
        
        .company-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 12px 0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }
        
        .dabur-color { /* TATA POWER color */
            background-color: var(--primary);
        }
        
        .hul-color { /* NTPC color */
            background-color: var(--secondary);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .data-table th {
            background-color: rgba(31, 119, 180, 0.1);
            font-weight: 600;
        }
        
        .data-table tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }
        
        .revenue-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .dashboard-section {
            margin-bottom: 30px;
        }
        
        .nav-tabs {
            display: flex;
            border-bottom: 1px solid var(--border);
            margin-bottom: 20px;
            background-color: var(--card-bg);
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }
        
        .nav-tab {
            padding: 15px 30px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-tab.active {
            border-bottom: 3px solid var(--primary);
            background-color: rgba(31, 119, 180, 0.05);
            color: var(--primary);
        }
        
        .nav-tab:hover {
            background-color: rgba(31, 119, 180, 0.1);
        }
        
        .page-content {
            display: none;
        }
        
        .page-content.active {
            display: block;
        }
        
        .trend-charts-grid {
            display: grid;
            grid-template-columns: 1fr;
        }
        
        .comparison-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .control-label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }
        
        @media (min-width: 992px) {
            .trend-charts-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .metric-grid {
                grid-template-columns: 1fr;
            }
            
            .revenue-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            h2 {
                font-size: 1.4rem;
            }
            
            .data-table {
                font-size: 0.85rem;
            }
            
            header {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .nav-tab {
                text-align: center;
                border-bottom: 1px solid var(--border);
            }
            
            .chart-container {
                height: 280px;
            }
            
            .comparison-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                TATA POWER
            </div>
            <div class="header-content">
                <h1>Financial Dashboard: TATA POWER vs NTPC</h1>
                <p>A comparative financial ratio analysis (2021â€“2025)</p>
            </div>
        </header>
        
        <div class="nav-tabs">
            <div class="nav-tab active" data-page="analysis">Financial Analysis</div>
            <div class="nav-tab" data-page="data">Raw Data</div>
        </div>
        
        <div class="page-content active" id="analysis-page">
            <div class="dashboard-section">
                <div class="card">
                    <h2>ðŸ“Š Executive Summary: Key Metrics Overview (2021-2025)</h2>
                    <div id="summary-table-container">
                        </div>
                </div>
            </div>
            
            <div class="divider"></div>
            
            <div class="dashboard-section">
                <h2>ðŸ“ˆ TATA POWER Trend Analysis</h2>
                <div class="trend-charts-grid">
                    <div class="card">
                        <h3>ðŸ“‰ Liquidity Ratios</h3>
                        <div class="chart-container" id="liquidity-chart"></div>
                    </div>
                    
                    <div class="card">
                        <h3>ðŸ“‰ Solvency Ratios</h3>
                        <div class="chart-container" id="solvency-chart"></div>
                    </div>
                    
                    <div class="card">
                        <h3>ðŸ“‰ Profitability Ratios</h3>
                        <div class="chart-container" id="profitability-chart"></div>
                    </div>
                    
                    <div class="card">
                        <h3>ðŸ“‰ Efficiency Ratios</h3>
                        <div class="chart-container" id="efficiency-chart"></div>
                    </div>
                </div>
            </div>
            
            <div class="divider"></div>
            
            <div class="dashboard-section">
                <h2>âš– Company Comparison: TATA POWER vs NTPC</h2>
                
                <div class="card">
                    <h3>ðŸ“Š Financial Ratios Comparison</h3>
                    <div class="comparison-controls">
                        <div class="control-group">
                            <div class="control-label">Select Ratio:</div>
                            <select id="ratio-select">
                                <option value="Gross_Margin">Gross Margin</option>
                                <option value="Net_Margin">Net Margin</option>
                                <option value="Current_Ratio">Current Ratio</option>
                                <option value="Quick_Ratio">Quick Ratio</option>
                                <option value="Cash_Ratio">Cash Ratio</option>
                                <option value="Dept_to_Equity_Ratio">Debt to Equity</option>
                                <option value="Dept_Ratio">Debt Ratio</option>
                                <option value="ROE">ROE</option>
                                <option value="Asset_Turnover">Asset Turnover</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <div class="control-label">Year Range:</div>
                            <select id="year-range-select">
                                <option value="all">All Years (2021-2025)</option>
                                <option value="2021-2023">2021-2023</option>
                                <option value="2023-2025">2023-2025</option>
                                <option value="2024-2025">2024-2025</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="company-legend">
                        <div class="legend-item">
                            <div class="legend-color dabur-color"></div>
                            <span>TATA POWER</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color hul-color"></div>
                            <span>NTPC</span>
                        </div>
                    </div>
                    <div class="chart-container" id="comparison-bar-chart"></div>
                    
                    <h3>ðŸ’¡ Insights (Comparing 2025)</h3>
                    <ul class="insights-list" id="insights-container">
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="page-content" id="data-page">
            <div class="dashboard-section">
                <h2>ðŸ“‹ Financial Data (TATA POWER and NTPC)</h2>
                
                <div class="card">
                    <h3>TATA POWER Financial Data</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Year</th>
                                <th>Revenue (Net)</th>
                                <th>Gross Margin</th>
                                <th>Net Margin</th>
                                <th>ROA</th>
                                <th>Current Ratio</th>
                                <th>Quick Ratio</th>
                                <th>Cash Ratio</th>
                                <th>Debt to Equity</th>
                                <th>Debt Ratio</th>
                                <th>ROE</th>
                                <th>Asset Turnover</th>
                            </tr>
                        </thead>
                        <tbody id="dabur-data-table-body">
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <h3>NTPC Financial Data</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Year</th>
                                <th>Revenue (Net)</th>
                                <th>Gross Margin</th>
                                <th>Net Margin</th>
                                <th>ROA</th>
                                <th>Current Ratio</th>
                                <th>Quick Ratio</th>
                                <th>Cash Ratio</th>
                                <th>Debt to Equity</th>
                                <th>Debt Ratio</th>
                                <th>ROE</th>
                                <th>Asset Turnover</th>
                            </tr>
                        </thead>
                        <tbody id="hul-data-table-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // TATA POWER Data
        const daburData = [
            {"Year": 2021, "Revenue_Net": 6050.4, "Gross_Margin": 0.6378, "Net_Margin": 0.124, "ROA": 0.0215, "Current_Ratio": 0.497, "Quick_Ratio": 0.411, "Cash_Ratio": 0.014, "Dept_to_Equity_Ratio": 1.112, "Dept_Ratio": 0.438, "ROE": 0.058, "Asset_Turnover": 0.185, "Inventory_Turnover": 0.0},
            {"Year": 2022, "Revenue_Net": 10898.03, "Gross_Margin": 0.4774, "Net_Margin": 0.1974, "ROA": 0.059, "Current_Ratio": 0.577, "Quick_Ratio": 0.503, "Cash_Ratio": 0.005, "Dept_to_Equity_Ratio": 2.271, "Dept_Ratio": 0.524, "ROE": 0.268, "Asset_Turnover": 0.313, "Inventory_Turnover": 0.0},
            {"Year": 2023, "Revenue_Net": 17437.45, "Gross_Margin": 0.3848, "Net_Margin": 0.1498, "ROA": 0.0678, "Current_Ratio": 0.436, "Quick_Ratio": 0.327, "Cash_Ratio": 0.016, "Dept_to_Equity_Ratio": 1.596, "Dept_Ratio": 0.454, "ROE": 0.241, "Asset_Turnover": 0.458, "Inventory_Turnover": 0.0},
            {"Year": 2024, "Revenue_Net": 19811.63, "Gross_Margin": 0.3739, "Net_Margin": 0.1016, "ROA": 0.0442, "Current_Ratio": 0.501, "Quick_Ratio": 0.395, "Cash_Ratio": 0.038, "Dept_to_Equity_Ratio": 1.237, "Dept_Ratio": 0.387, "ROE": 0.145, "Asset_Turnover": 0.445, "Inventory_Turnover": 0.0},
            {"Year": 2025, "Revenue_Net": 22068.32, "Gross_Margin": 0.4382, "Net_Margin": 0.1261, "ROA": 0.0595, "Current_Ratio": 0.504, "Quick_Ratio": 0.404, "Cash_Ratio": 0.097, "Dept_to_Equity_Ratio": 0.924, "Dept_Ratio": 0.322, "ROE": 0.174, "Asset_Turnover": 0.482, "Inventory_Turnover": 0.0}
        ];
        
        // NTPC Data
        const hulData = [
            {"Year": 2021, "Revenue_Net": 99039.63, "Gross_Margin": 0.4604, "Net_Margin": 0.133, "ROA": 0.0337, "Current_Ratio": 0.972, "Quick_Ratio": 5.452, "Cash_Ratio": 0.039, "Dept_to_Equity_Ratio": 1.384, "Dept_Ratio": 0.881, "ROE": 0.118, "Asset_Turnover": 0.309, "Inventory_Turnover": 0.0},
            {"Year": 2022, "Revenue_Net": 115021.82, "Gross_Margin": 0.4367, "Net_Margin": 0.1342, "ROA": 0.0386, "Current_Ratio": 0.948, "Quick_Ratio": 5.124, "Cash_Ratio": 0.038, "Dept_to_Equity_Ratio": 1.245, "Dept_Ratio": 0.831, "ROE": 0.128, "Asset_Turnover": 0.344, "Inventory_Turnover": 0.0},
            {"Year": 2023, "Revenue_Net": 161689.57, "Gross_Margin": 0.4008, "Net_Margin": 0.1025, "ROA": 0.0398, "Current_Ratio": 1.043, "Quick_Ratio": 4.869, "Cash_Ratio": 0.051, "Dept_to_Equity_Ratio": 1.21, "Dept_Ratio": 0.818, "ROE": 0.129, "Asset_Turnover": 0.455, "Inventory_Turnover": 0.0},
            {"Year": 2024, "Revenue_Net": 160336.51, "Gross_Margin": 0.4091, "Net_Margin": 0.1091, "ROA": 0.0435, "Current_Ratio": 1.061, "Quick_Ratio": 4.523, "Cash_Ratio": 0.057, "Dept_to_Equity_Ratio": 1.043, "Dept_Ratio": 0.743, "ROE": 0.122, "Asset_Turnover": 0.427, "Inventory_Turnover": 0.0},
            {"Year": 2025, "Revenue_Net": 168244.06, "Gross_Margin": 0.4219, "Net_Margin": 0.1127, "ROA": 0.0461, "Current_Ratio": 1.142, "Quick_Ratio": 4.641, "Cash_Ratio": 0.058, "Dept_to_Equity_Ratio": 0.95, "Dept_Ratio": 0.708, "ROE": 0.124, "Asset_Turnover": 0.435, "Inventory_Turnover": 0.0}
        ];

        // Core metrics available for all companies (excluding Inventory Turnover)
        const ratioMetrics = [
            "Gross_Margin", "Net_Margin", "ROA", "Current_Ratio", "Quick_Ratio", 
            "Cash_Ratio", "Dept_to_Equity_Ratio", "Dept_Ratio", "ROE", "Asset_Turnover"
        ];
        
        // Key metrics for the executive summary table
        const summaryMetrics = {
            "Profitability": "Net_Margin",
            "Liquidity": "Current_Ratio",
            "Solvency": "Dept_to_Equity_Ratio",
            "Efficiency": "Asset_Turnover",
            "Return": "ROE"
        };
        
        // Ratio categories for TATA POWER trend analysis
        const ratioCategories = {
            "Liquidity Ratios": ["Current_Ratio", "Quick_Ratio", "Cash_Ratio"],
            "Solvency Ratios": ["Dept_to_Equity_Ratio", "Dept_Ratio", "ROE"],
            "Profitability Ratios": ["Gross_Margin", "Net_Margin", "ROA"],
            "Efficiency Ratios": ["Asset_Turnover"]
        };
        
        // Colors for trend analysis charts
        const trendColors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728', '#9467bd'];
        
        // Initialize the dashboard
        function initDashboard() {
            createSummaryTable();
            createTrendCharts();
            updateDataTables();
            updateComparison();
            setupNavigation();
            
            document.getElementById('ratio-select').addEventListener('change', updateComparisonBarChart);
            document.getElementById('year-range-select').addEventListener('change', updateComparisonBarChart);
        }
        
        // Setup navigation between pages
        function setupNavigation() {
            const navTabs = document.querySelectorAll('.nav-tab');
            navTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
                    
                    tab.classList.add('active');
                    const pageId = tab.getAttribute('data-page');
                    document.getElementById(`${pageId}-page`).classList.add('active');
                });
            });
        }
        
        // Create the all-years summary table
        function createSummaryTable() {
            const container = document.getElementById('summary-table-container');
            const years = [2021, 2022, 2023, 2024, 2025];
            let tableHTML = '<table class="data-table">';
            
            tableHTML += '<thead><tr><th>Metric</th><th>Company</th>';
            years.forEach(year => tableHTML += `<th>${year}</th>`);
            tableHTML += '</tr></thead><tbody>';
            
            Object.entries(summaryMetrics).forEach(([category, metricKey]) => {
                const isPercentage = ["Net_Margin", "ROE"].includes(metricKey);
                
                tableHTML += `<tr><td rowspan="2"><b>${category}</b><br><small>${metricKey.replace(/_/g, ' ')}</small></td><td>TATA POWER</td>`;
                years.forEach(year => {
                    const data = daburData.find(d => d.Year === year);
                    let value = data ? data[metricKey] : NaN;
                    let displayValue = isNaN(value) ? 'N/A' : (isPercentage ? (value * 100).toFixed(2) + '%' : value.toFixed(3));
                    tableHTML += `<td>${displayValue}</td>`;
                });
                tableHTML += '</tr>';

                tableHTML += `<tr><td>NTPC</td>`;
                years.forEach(year => {
                    const data = hulData.find(d => d.Year === year);
                    let value = data ? data[metricKey] : NaN;
                    let displayValue = isNaN(value) ? 'N/A' : (isPercentage ? (value * 100).toFixed(2) + '%' : value.toFixed(3));
                    tableHTML += `<td>${displayValue}</td>`;
                });
                tableHTML += '</tr>';
            });
            tableHTML += '</tbody></table>';
            
            container.innerHTML = tableHTML;
        }

        // Create trend charts for TATA POWER
        function createTrendCharts() {
            createDaburTrendChart('liquidity-chart', ratioCategories["Liquidity Ratios"], "Liquidity Ratios - 5 Year Trend (TATA POWER)");
            createDaburTrendChart('solvency-chart', ratioCategories["Solvency Ratios"], "Solvency Ratios - 5 Year Trend (TATA POWER)");
            createDaburTrendChart('profitability-chart', ratioCategories["Profitability Ratios"], "Profitability Ratios - 5 Year Trend (TATA POWER)");
            createDaburTrendChart('efficiency-chart', ratioCategories["Efficiency Ratios"], "Efficiency Ratios - 5 Year Trend (TATA POWER)");
        }
        
        function createDaburTrendChart(containerId, ratios, title) {
            const years = daburData.map(d => d.Year);
            const traces = ratios.map((ratio, index) => ({
                x: years,
                y: daburData.map(d => d[ratio]),
                type: 'scatter',
                mode: 'lines+markers',
                name: ratio.replace(/_/g, ' '),
                line: { color: trendColors[index % trendColors.length], width: 2 },
                marker: { color: trendColors[index % trendColors.length], size: 6 }
            }));
            
            const layout = {
                title: title,
                xaxis: { title: 'Year', type: 'category' },
                yaxis: { title: 'Ratio Value' },
                showlegend: true,
                legend: { orientation: 'h', y: -0.3 },
                margin: { t: 50, b: 80, l: 60, r: 40 }
            };
            
            Plotly.newPlot(containerId, traces, layout, { responsive: true });
        }
        
        // Update data tables in the "Raw Data" tab
        function updateDataTables() {
            populateTable('dabur-data-table-body', daburData);
            populateTable('hul-data-table-body', hulData);
        }

        function populateTable(tableBodyId, dataArray) {
            const tableBody = document.getElementById(tableBodyId);
            tableBody.innerHTML = '';
            const headers = Object.keys(dataArray[0]).filter(key => key !== 'Inventory_Turnover');
            
            dataArray.forEach(dataRow => {
                const row = document.createElement('tr');
                headers.forEach(key => {
                    const cell = document.createElement('td');
                    let value = dataRow[key];
                    let displayValue = 'N/A';
                    
                    if (value !== null && typeof value !== 'undefined') {
                        const isPercentage = ["Gross_Margin", "Net_Margin", "ROA", "ROE"].includes(key);
                        if (key === 'Year') displayValue = value;
                        else if (key === 'Revenue_Net') displayValue = value.toFixed(2);
                        else if (isPercentage) displayValue = (value * 100).toFixed(2) + '%';
                        else displayValue = value.toFixed(3);
                    }
                    cell.textContent = displayValue;
                    row.appendChild(cell);
                });
                tableBody.appendChild(row);
            });
        }
        
        // Update the comparison section
        function updateComparison() {
            updateComparisonBarChart();
            updateInsights();
        }
        
        function updateComparisonBarChart() {
            const selectedRatio = document.getElementById('ratio-select').value;
            const yearRange = document.getElementById('year-range-select').value;
            
            let years = [2021, 2022, 2023, 2024, 2025];
            if (yearRange === '2021-2023') years = [2021, 2022, 2023];
            else if (yearRange === '2023-2025') years = [2023, 2024, 2025];
            else if (yearRange === '2024-2025') years = [2024, 2025];
            
            const filterData = (dataArray) => years.map(year => {
                const data = dataArray.find(d => d.Year === year);
                return data ? data[selectedRatio] : null;
            });
            
            const trace1 = { x: years, y: filterData(daburData), type: 'bar', name: 'TATA POWER', marker: { color: '#1f77b4' } };
            const trace2 = { x: years, y: filterData(hulData), type: 'bar', name: 'NTPC', marker: { color: '#ff7f0e' } };
            
            const ratioName = selectedRatio.replace(/_/g, ' ');
            const layout = {
                title: `${ratioName} Comparison: TATA POWER vs NTPC`,
                xaxis: { title: 'Year', tickvals: years, type: 'category' },
                yaxis: { title: ratioName },
                barmode: 'group',
                showlegend: true,
                margin: { t: 50, b: 80, l: 60, r: 40 }
            };
            
            Plotly.newPlot('comparison-bar-chart', [trace1, trace2], layout, { responsive: true });
        }
        
        function updateInsights() {
            const year = 2025;
            const daburYearData = daburData.find(d => d.Year === year);
            const hulYearData = hulData.find(d => d.Year === year);
            const insightsContainer = document.getElementById('insights-container');
            insightsContainer.innerHTML = '';
            
            if (daburYearData && hulYearData) {
                ratioMetrics.forEach(key => {
                    const daburVal = daburYearData[key];
                    const hulVal = hulYearData[key];
                    if (daburVal === null || hulVal === null) return;
                    
                    let insightText = '';
                    let insightClass = '';
                    const reverseLogic = ["Dept_to_Equity_Ratio", "Dept_Ratio"].includes(key);
                    
                    if ((daburVal > hulVal && !reverseLogic) || (daburVal < hulVal && reverseLogic)) {
                        insightText = `âœ… TATA POWER has a better ${key.replace(/_/g, ' ')} (${daburVal.toFixed(3)} vs ${hulVal.toFixed(3)})`;
                        insightClass = 'insight-positive';
                    } else if ((daburVal < hulVal && !reverseLogic) || (daburVal > hulVal && reverseLogic)) {
                        insightText = `âš  NTPC has a better ${key.replace(/_/g, ' ')} (${hulVal.toFixed(3)} vs ${daburVal.toFixed(3)})`;
                        insightClass = 'insight-warning';
                    }
                    
                    if (insightText) {
                        const insightItem = document.createElement('li');
                        insightItem.className = `insight-item ${insightClass}`;
                        insightItem.textContent = insightText;
                        insightsContainer.appendChild(insightItem);
                    }
                });
            }
        }
        
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>

</html>
